!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;"undefined"!=typeof window?t=window:"undefined"!=typeof global?t=global:"undefined"!=typeof self&&(t=self),t.jtmpl=e()}}(function(){var define,module,exports;return function e(t,n,o){function r(c,l){if(!n[c]){if(!t[c]){var a="function"==typeof require&&require;if(!l&&a)return a(c,!0);if(i)return i(c,!0);throw new Error("Cannot find module '"+c+"'")}var s=n[c]={exports:{}};t[c][0].call(s.exports,function(e){var n=t[c][1][e];return r(n?n:e)},s,s.exports,e,t,n,o)}return n[c].exports}for(var i="function"==typeof require&&require,c=0;c<o.length;c++)r(o[c]);return r}({1:[function(e,t){function n(e){if(!(this instanceof n))return new n(e);e||(e={}),e.nodeType&&(e={el:e}),this.opts=e,this.el=e.el||document.body,"object"!=typeof this.el&&(this.el=document.querySelector(this.el))}t.exports=function(e){return new n(e)},n.prototype.add=function(e){var t=this.el;if(t){if(""===t.className)return t.className=e;var n=t.className.split(" ");return n.indexOf(e)>-1?n:(n.push(e),t.className=n.join(" "),n)}},n.prototype.remove=function(e){var t=this.el;if(t&&""!==t.className){var n=t.className.split(" "),o=n.indexOf(e);return o>-1&&n.splice(o,1),t.className=n.join(" "),n}},n.prototype.has=function(e){var t=this.el;if(t){var n=t.className.split(" ");return n.indexOf(e)>-1}}},{}],2:[function(e,t){"use strict";function n(e,t,o,r){function i(e,t){if(!e)throw t||"assertion failed"}function c(e,t){for(var n=0,o=Object.getOwnPropertyNames(t),r=o.length;r>n;n++)e[o[n]]=t[o[n]]}function l(e,t){if("object"==typeof e&&null!==e&&"object"==typeof t&&null!==t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(var n in e){if(!t.hasOwnProperty(n))return!1;if(!l(e[n],t[n]))return!1}return!0}return e!==t?!1:!0}function a(){var e=arguments[0],t=["string","number"].indexOf(typeof arguments[1])>-1?arguments[1]:null,n="function"==typeof arguments[1]?arguments[1]:"function"==typeof arguments[2]?arguments[2]:null;i(["change","update","insert","delete"].indexOf(e)>-1),i(["change"].indexOf(e)>-1&&null!==t||["insert","delete","update"].indexOf(e)>-1&&null===t),N[e][t]||(N[e][t]=[]),-1===N[e][t].indexOf(n)&&N[e][t].push(n)}function s(){var e,t=arguments[0],n="string"==typeof arguments[1]?arguments[1]:null,o="function"==typeof arguments[1]?arguments[1]:"function"==typeof arguments[2]?arguments[2]:null;N[t][n]&&(o?(e=N[t][n].indexOf(o),e>-1&&N[t][n].splice(e,1)):N[t][n]=[])}function u(e,t,n){(N[e][["change"].indexOf(e)>-1?t:null]||[]).map(function(e){e.call(O,t,n)})}function d(){function t(e){var n,o=Array.isArray(e)?[]:{};for(n in e)"object"==typeof e[n]?o[n]=t(e[n]):"function"!=typeof e[n]&&"_"!==n[0]&&(o[n]=e[n]);return o}return JSON.stringify(t(e))}function p(t){var n;"string"==typeof t&&(t=JSON.parse(t));for(n in t)e[n]=t[n]}function f(e){l(b[e],h(e))||u("change",e);for(var t=0,n=_[e]||[],o=n.length;o>t;t++)delete R[n[t]],x[e][t].trigger("update",n[t]);O.parent&&O.parent.trigger("update",O.prop,e)}function m(e){function n(t){return function(n,o){return t._dependentProps[n]||(t._dependentProps[n]=[],t._dependentContexts[n]=[]),-1===t._dependentProps[n].indexOf(e)&&(t._dependentProps[n].push(e),t._dependentContexts[n].push(O)),t(n,o)}}var r=n(O);return E(r),o&&(r.parent=n(o)),r.root=n(t||O),r}function h(t,n){var o=e[t];return b[t]="function"==typeof o?o.call(m(t),n):o}function g(e,o){var r=h(e,o);return r&&"object"==typeof r?R[e]?R[e]:R[e]=n(r,t||O,O,e):r}function v(t,n){var o=h(t);"function"==typeof e[t]?e[t].call(m(t),n):(e[t]=n,n&&"object"==typeof n&&delete b[t]),o!==n&&u("update",t)}function y(e,t){return(void 0===t||"function"==typeof t?g:v)(e,t)}function E(n){function i(t,o){return function(){var r=[][t].apply(e,arguments);return this.len=this.values.length,o.apply(this,arguments),n.parent.trigger("update",n.prop),r}}c(n,{values:e,parent:o||null,root:t||n,prop:void 0===r?null:r,on:a,off:s,trigger:u,toJSON:d,fromJSON:p,_dependentProps:_,_dependentContexts:x}),Array.isArray(e)&&c(n,{len:e.length,pop:i("pop",function(){u("delete",this.len,1)}),push:i("push",function(){u("insert",this.len-1,1)}),reverse:i("reverse",function(){b={},u("delete",0,this.len),u("insert",0,this.len)}),shift:i("shift",function(){b={},u("delete",0,1)}),unshift:i("unshift",function(){b={},u("insert",0,1)}),sort:i("sort",function(){b={},u("delete",0,this.len),u("insert",0,this.len)}),splice:i("splice",function(){b={},arguments[1]&&u("delete",arguments[0],arguments[1]),arguments.length>2&&u("insert",arguments[0],arguments.length-2)})})}var N={change:{},update:{},insert:{},delete:{}},_={},x={},b={},R={};a("update",f);var O=function(){return y.apply(null,arguments)};return E(O),O}"object"==typeof t&&(t.exports=n)},{}],3:[function(e,t){t.exports=function t(n,o,r){function i(e){return(e+"").replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1")}function c(e,t){return RegExp(i(e.delimiters[0])+"("+C.RE_ANYTHING+")"+i(e.delimiters[1]),t)}function l(t,n,o,r,i){var c,l,a=e("./rules"),s=a.length;for(t=t.slice(i.delimiters[0].length,-i.delimiters[1].length),c=0;s>c;c++)if(l=a[c](t,n,o,r,i))return l.index=c,l}function a(e,t){return e=e.replace(RegExp(i(t.delimiters[0]+"{")+C.RE_SRC_IDENTIFIER+i("}"+t.delimiters[1]),"g"),t.delimiters[0]+"&$1"+t.delimiters[1]),e=e.replace(c(t,"g"),function(t,n,o){var r=e.slice(0,o),i=!!r.match(RegExp("<"+C.RE_SRC_IDENTIFIER+"[^>]*?$")),c=!!r.match(/<!--\s*$/),l=0===n.indexOf("!");return i||c?l?"":t:"<!--"+t+"-->"})}function s(e,t,n){var o=t.match(RegExp(i(n.delimiters[0])+"\\/"+C.RE_SRC_IDENTIFIER+"?"+i(n.delimiters[1])));return o?""===e||!o[1]||o[1]===e:!1}var u,d,p,f,m,h,g,v,y,E,N,_,x,b,R,O,I,T,S,j,D,C=e("./consts"),w=document.createDocumentFragment(),L=e("freak");for(r=r||e("./default-options"),o="function"==typeof o?o:L("object"==typeof o?o:{".":o}),n.nodeType?x=n:(n=a(n,r),D=document.createElement("iframe"),D.style.display="none",document.body.appendChild(D),D.contentDocument.writeln("<!doctype html>\n<html><body><div>"+n+"</div></body></html>"),x=D.contentDocument.body.children[0],document.body.removeChild(D)),u=0,d=x.childNodes,p=d.length;p>u;u++)switch(b=d[u],R=b.cloneNode(!1),w.appendChild(R),R.nodeType){case 1:for(R.__jtmpl__=o,f=0,m=R.attributes.length;m>f;f++){for(h=R.attributes[f],v=[],E="",g=h.value,O=c(r,"g");I=O.exec(g);)if(T=l(I[0],R,h.name.toLowerCase(),o,r)){if(v.push(T),T.block){for(S=I[0],N=I.index,_=I.index+I[0].length;I&&!s(T.block,I[0],r);I=O.exec(g));if(!I)throw"Unclosed"+S;E+=g.slice(0,N)+T.replace(h.value.slice(_,I.index))+g.slice(I.index+I[0].length)}T.block||void 0===T.replace||(h.value=T.replace)}for(v.length&&(h.value=E),y=0;y<v.length;y++)T=v[y],T.change&&(o.on("change",T.block||T.prop,T.change),T.change())}j=t(b,o,r),j.childNodes.length&&R.appendChild(j);break;case 8:if(s("",R.data,r))throw"jtmpl: Unexpected "+R.data;if((I=R.data.match(c(r)))&&(T=l(R.data,b,null,o,r))){if(T.replace.nodeType&&R.parentNode.replaceChild(T.replace,R),T.block){for(S=document.createDocumentFragment(),u++;p>u&&!s(T.block,d[u].data||"",r);u++)S.appendChild(d[u].cloneNode(!0));if(u===p)throw"jtmpl: Unclosed "+R.data;R.parentNode.replaceChild(T.replace(S,R.parentNode),R)}T.prop&&T.change&&(o.on("change",T.prop,T.change),T.change())}}return w}},{"./consts":4,"./default-options":6,"./rules":9,freak:2}],4:[function(e,t){t.exports={RE_IDENTIFIER:/^[\w\.\-]+$/,RE_SRC_IDENTIFIER:"([\\w\\.\\-]+)",RE_PARTIAL:/>([\w\.\-]+)|'([^\']*)\'|"([^"]*)"/,RE_PIPE:/^[\w\.\-]+(?:\|[\w\.\-]+)?$/,RE_NODE_ID:/^#[\w\.\-]+$/,RE_ENDS_WITH_NODE_ID:/.+(#[\w\.\-]+)$/,RE_ANYTHING:"[\\s\\S]*?",RE_SPACE:"\\s*"}},{}],5:[function(e,t){t.exports=function(e,t){var n=!1,o=!0,r=e.document,i=r.documentElement,c=r.addEventListener,l=c?"addEventListener":"attachEvent",a=c?"removeEventListener":"detachEvent",s=c?"":"on",u=function(o){("readystatechange"!=o.type||"complete"==r.readyState)&&(("load"==o.type?e:r)[a](s+o.type,u,!1),!n&&(n=!0)&&t.call(e,o.type||o))},d=function(){try{i.doScroll("left")}catch(e){return void setTimeout(d,50)}u("poll")};if("complete"==r.readyState)t.call(e,"lazy");else{if(!c&&i.doScroll){try{o=!e.frameElement}catch(e){}o&&d()}r[l](s+"DOMContentLoaded",u,!1),r[l](s+"readystatechange",u,!1),e[l](s+"load",u,!1)}}},{}],6:[function(e,t){t.exports={delimiters:["{{","}}"]}},{}],7:[function(_dereq_,module,exports){module.exports=function(target,src,model){function mixin(e,t){for(var n in t)0===n.indexOf("__")&&n.lastIndexOf("__")===n.length-2||"function"==typeof t[n]?void 0===e.values[n]&&(e.values[n]=t[n]):void 0===e(n)&&e(n,t[n])}function applyPlugins(){var e,t;for(e in jtmpl.plugins)plugin=jtmpl.plugins[e],t=model.values["__"+e+"__"],"function"==typeof plugin&&void 0!==t&&plugin.call(model,t,target)}function evalObject(body,src){var result,module={exports:{}};return src=src?"\n//@ sourceURL="+src+"\n//# sourceURL="+src:"",body.match(/^\s*{[\S\s]*}\s*$/)?eval("(function(){ var result="+body+";return result})()"+src):(eval(body+src),module.exports)}function loadModel(e,t,n){var o;if(e)if(e.match(consts.RE_NODE_ID)){var r=n.querySelector(e);mixin(model,evalObject(r.innerHTML,e)),applyPlugins(),jtmpl(target,t,model)}else o=e.indexOf("#"),jtmpl("GET",o>-1?e.substring(0,o):e,function(n){var o=e.match(consts.RE_ENDS_WITH_NODE_ID),r=o&&(new DOMParser).parseFromString(n,"text/html").querySelector(o[1]);mixin(model,evalObject(o?r.innerHTML:n,e)),applyPlugins(),jtmpl(target,t,model)});else jtmpl(target,t,model)}function loadTemplate(){var e;if(src)if(src.match(consts.RE_NODE_ID)){var t=document.querySelector(src);loadModel(t.getAttribute("data-model"),t.innerHTML,document)}else e=src.indexOf("#"),jtmpl("GET",e>-1?src.substring(0,e):src,function(e){var t,n=src.match(consts.RE_ENDS_WITH_NODE_ID);n?(t=document.implementation.createHTMLDocument(""),t.documentElement.innerHTML=e):t=document;var o=n&&t.querySelector(n[1]);loadModel(n?o.getAttribute("data-model"):"",n?o.innerHTML:e,t)})}var consts=_dereq_("./consts");model=model||{},"function"!=typeof model&&(model=jtmpl.freak(model)),loadTemplate()}},{"./consts":4}],8:[function(e,t){function n(){var t,r,i,c,l=[].slice.call(arguments);return["GET","POST"].indexOf(l[0])>-1?e("./xhr").apply(null,l):1===l.length&&"string"==typeof l[0]?document.querySelector(l[0]).__jtmpl__:void((l[0]&&l[0].nodeType||"string"==typeof l[0])&&(l[1]&&"function"==typeof l[1].appendChild||"string"==typeof l[1])&&void 0!==l[2]&&(t=l[0]&&l[0].nodeType?l[0]:document.querySelector(l[0]),i=l[1].match(o.RE_NODE_ID)?document.querySelector(l[1]).innerHTML:l[1],c="function"==typeof l[2]?l[2]:n.freak("object"==typeof l[2]?l[2]:"string"==typeof l[2]&&l[2].match(o.RE_NODE_ID)?e("./loader")(document.querySelector(l[2]).innerHTML):{".":l[2]}),"SCRIPT"===t.nodeName&&(r=document.createElement("div"),r.id=t.id,t.parentNode.replaceChild(r,t),t=r),t.__jtmpl__=c,t.innerHTML="",t.appendChild(e("./compiler")(i,c,l[3]))))}var o=e("./consts");e("./content-loaded")(window,function(){for(var t=e("./loader"),n=document.querySelectorAll("[data-jtmpl]"),o=0,r=n.length;r>o;o++)t(n[o],n[o].getAttribute("data-jtmpl"))}),n.freak=e("freak"),n.plugins={init:function(e){"function"==typeof e&&e.call(this)}},t.exports=n},{"./compiler":3,"./consts":4,"./content-loaded":5,"./loader":7,"./xhr":17,freak:2}],9:[function(e,t){t.exports=[e("./rules/value-var"),e("./rules/class-section"),e("./rules/section"),e("./rules/inverted-section"),e("./rules/partial"),e("./rules/unescaped-var"),e("./rules/var")]},{"./rules/class-section":10,"./rules/inverted-section":11,"./rules/partial":12,"./rules/section":13,"./rules/unescaped-var":14,"./rules/value-var":15,"./rules/var":16}],10:[function(e,t){t.exports=function(t,n,o,r){var i,c=t.match(new RegExp("(#|\\^)"+e("../consts").RE_SRC_IDENTIFIER)),l=c&&"^"===c[1],a=c&&c[2];return"class"===o&&c?{block:a,replace:function(e){return i=e,""},change:function(){var t=r(a);e("element-class")(n)[l===!t&&"add"||"remove"](i)}}:void 0}},{"../consts":4,"element-class":1}],11:[function(e,t){t.exports=function(t,n,o,r){function i(){for(var e,t,n="."===s?r:r(s);p;)d.parentNode.removeChild(d.previousSibling),p--;"function"==typeof n&&void 0!==n.len?(n.on("insert",i),n.on("delete",i),t=document.createDocumentFragment(),0===n.len&&t.appendChild(l(c,n(e))),p=t.childNodes.length,d.parentNode.insertBefore(t,d)):n||(t=l(c,r),p=t.childNodes.length,d.parentNode.insertBefore(t,d))}var c,l=e("../compiler"),a=t.match(new RegExp("^\\^"+e("../consts").RE_SRC_IDENTIFIER)),s=a&&a[1],u=document.createDocumentFragment(),d=document.createComment(""),p=0;return a&&!o?{prop:s,block:s,replace:function(e){return u.appendChild(d),c=e,d},change:i}:void 0}},{"../compiler":3,"../consts":4}],12:[function(e,t){t.exports=function(t,n,o,r){var i,c=e("../consts"),l=t.match(c.RE_PARTIAL),a=document.createComment(""),s=l&&function(){i||(i=a.parentNode),e("../loader")(i,l[1]?r(l[1]):l[2]||l[3],r)};return l?(l[1]&&r.on("change",l[1],s),setTimeout(s,0),{replace:a}):void 0}},{"../consts":4,"../loader":7}],13:[function(e,t){t.exports=function(t,n,o,r){function i(e){return function(){var t=m.parentNode,n=[].indexOf.call(t.childNodes,m),o=n-h+e*s.childNodes.length;t.replaceChild(u(s,r(p)(e)),t.childNodes[o])}}function c(e,t){var n,o,i=m.parentNode,c=[].indexOf.call(i.childNodes,m),l=c-h+e*s.childNodes.length,a=t*s.childNodes.length;for(n=0,o=document.createDocumentFragment();t>n;n++)o.appendChild(u(s,r(p)(e+n)));i.insertBefore(o,i.childNodes[l]),h+=a}function l(e,t){var n=m.parentNode,o=[].indexOf.call(n.childNodes,m),r=o-h+e*s.childNodes.length,i=t*s.childNodes.length;for(h-=i;i--;)n.removeChild(n.childNodes[r])}function a(){for(var e,t,n,o="."===p?r:r(p);h;)m.parentNode.removeChild(m.previousSibling),h--;if("function"==typeof o&&void 0!==o.len){for(o.on("insert",c),o.on("delete",l),n=document.createDocumentFragment(),e=0,t=o.len;t>e;e++)o.on("change",e,i(e)),n.appendChild(u(s,o(e)));h=n.childNodes.length,m.parentNode.insertBefore(n,m)}else"function"==typeof o&&void 0===o.len?(n=u(s,o),h=n.childNodes.length,m.parentNode.insertBefore(n,m)):o&&(n=u(s,r),h=n.childNodes.length,m.parentNode.insertBefore(n,m))}var s,u=e("../compiler"),d=t.match(new RegExp("^#"+e("../consts").RE_SRC_IDENTIFIER)),p=d&&d[1],f=document.createDocumentFragment(),m=document.createComment(""),h=0;return d?{prop:p,block:p,replace:function(e){return f.appendChild(m),s=e,m},change:a}:void 0}},{"../compiler":3,"../consts":4}],14:[function(e,t){t.exports=function(t,n,o,r){var i=t.match(new RegExp("^&"+e("../consts").RE_SRC_IDENTIFIER)),c=i&&i[1],l=document.createComment(""),a=0;return i&&!o?{prop:c,replace:l,change:function(){for(var e,t=document.createDocumentFragment(),n=document.createElement("body");a;)l.parentNode.removeChild(l.previousSibling),a--;for(n.innerHTML=r(c)||"",a=n.childNodes.length,e=0;a>e;e++)t.appendChild(n.childNodes[0]);l.parentNode.insertBefore(t,l)}}:void 0}},{"../consts":4}],15:[function(e,t){function n(e,t){var n;document.createEvent?(n=document.createEvent("HTMLEvents"),n.initEvent(t,!0,!0)):document.createEventObject&&(n=document.createEventObject(),n.eventType=t),n.eventName=t,e.dispatchEvent?e.dispatchEvent(n):e.fireEvent&&htmlEvents["on"+t]?e.fireEvent("on"+n.eventType,n):e[t]?e[t]():e["on"+t]&&e["on"+t]()}t.exports=function(t,o,r,i){function c(){var e=i(a);o[r]!==e&&(o[r]=e||"")}var l=t.match(e("../consts").RE_IDENTIFIER),a=l&&l[0];if(l&&["value","checked","selected"].indexOf(r)>-1){"OPTION"===o.nodeName&&setTimeout(function(){o&&o.parentNode&&o.parentNode.addEventListener("change",function(){i(a)!==o.selected&&i(a,o.selected)})},0),"radio"===o.type&&o.name&&o.addEventListener("change",function(){if(o[r])for(var e=0,t=document.querySelectorAll("input[type=radio][name="+o.name+"]"),c=t.length;c>e;e++)t[e]!==o&&n(t[e],"change");i(a,o[r])});var s=["text","password"].indexOf(o.type)>-1?"input":"change";return o.addEventListener(s,function(){i(a,o[r])}),{prop:a,replace:"",change:c}}}},{"../consts":4}],16:[function(e,t){t.exports=function(t,n,o,r){function i(){var e=r(t);return"function"==typeof e?JSON.stringify(e.values):e}var c,l;return t.match(e("../consts").RE_IDENTIFIER)?(o?l=function(){var e=i();return e?n.setAttribute(o,e):n.removeAttribute(o)}:(c=document.createTextNode(""),l=function(){c.data=i()||""}),{prop:t,replace:c,change:l}):void 0}},{"../consts":4}],17:[function(e,t){t.exports=function(){var e,t,n,o,r,i=[].slice.call(arguments),c=new XMLHttpRequest,l=i.reduce(function(e,t){return"function"==typeof t?t:e},null),a=i[i.length-1];for("object"!=typeof a&&(a={}),e=0,o=Object.getOwnPropertyNames(a),t=o.length;t>e;e++)n=o[e],c[n]=a[n];r="string"==typeof i[2]?i[2]:"object"==typeof i[2]?Object.keys(i[2]).map(function(e){return e+"="+encodeURIComponent(i[2][e])}).join("&"):"",c.onload=function(e){var t;if(l){try{t=JSON.parse(this.responseText)}catch(e){t=this.responseText}l.call(this,t,e)}},c.open(i[0],i[1],void 0!==a.async?a.async:!0,a.user,a.password),c.send(r)}},{}],18:[function(e,t){e("./polyfills/matches");var n=e("jtmpl-core/src/main");n.plugins.on=e("./plugins/on"),n.plugins.routes=e("./plugins/routes"),t.exports=n},{"./plugins/on":19,"./plugins/routes":20,"./polyfills/matches":21,"jtmpl-core/src/main":8}],19:[function(e,t){t.exports=function(e,t){function n(n){t.addEventListener(n,function(t){for(var o in e[n])t.target.matches(o)&&e[n][o].call(t.target.__jtmpl__,t)})}for(var o in e)n(o)}},{}],20:[function(e,t){t.exports=function(){}},{}],21:[function(){"undefined"!=typeof Element&&function(e){e.matches=e.matches||e.mozMatchesSelector||e.msMatchesSelector||e.oMatchesSelector||e.webkitMatchesSelector||function(e){for(var t=this,n=(t.parentNode||t.document).querySelectorAll(e),o=-1;n[++o]&&n[o]!=t;);return!!n[o]}}(Element.prototype)},{}]},{},[18])(18)});